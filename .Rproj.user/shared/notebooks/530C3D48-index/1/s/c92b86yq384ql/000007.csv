"0","# -- Import file and create dataframe"
"0",""
"0","# Create file path"
"0","files <- list.files(path = ""./results"", pattern = ""*.xlsx"", full.names = T)"
"0",""
"0","# Import files into dataframe"
"0","res <- map_dfr(files, read_xlsx)"
"0","View(res)"
"0",""
"0","## -- Calculate points per competition"
"0",""
"0","# Add new variable ""points"""
"0","res <- res %>% mutate(points = case_when("
"0","  place == 1 ~ 32,"
"0","  place == 2 ~ 26,"
"0","  place == 3 ~ 21,"
"0","  place == 4 ~ 19,"
"0","  place > 4 & place < 9 ~ 14,"
"0","  place > 8 & place < 17 ~ 8,"
"0","  place >16 & place < 33 ~ 4,"
"0","  TRUE ~ 0"
"0","))"
"0","#View(res)"
"0",""
"0",""
"0","##  Change format for output - create ""pivot table"" with points per competition"
"0","piv_comp <- res %>% "
"0","  select(name, competition, points) %>% "
"0","  pivot_wider(names_from = competition, values_from = points )"
"0","View(piv_comp)"
"0",""
"0","## Calculate grand total points for all competitions (1-2)"
"0","grand_tot_1to2 <- res %>% group_by(name) %>%"
"0","  summarise(sum_points = sum(points))"
"0","View(grand_tot_1to2)"
"0",""
"0","# Create new piv df with totals column"
"0","res_1to2 <- piv_comp %>%"
"0","  full_join(grand_tot_1to2, by = ""name"") %>% "
"0","  arrange(desc(sum_points))"
"0","View(res_1to2)"
"0",""
"0",""
